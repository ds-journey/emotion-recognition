### Определение человеческих эмоций по данным с камер видеонаблюдений
<hr/>

Задача проекта — улучшить опыт от посещения музеев, городов или новых мест с помощью информационных технологий.

Цель проекта — сделать посещение людьми музеев, городов или новых мест интересным, информативным и комфортным.

#### Предлагаемое решение

Для реализации цели предлагается приложение по распознаванию эмоций
с помощью модели машинного обучения (нейронной сети).  

Приложение по распознаванию эмоций может быть полезно в музеях по
нескольким причинам.  

Например, анализируя, какие эмоции получают посетители от тех или иных
экспонатов, музей может адаптировать свои
коллекции таким образом, чтобы добиться желаемого отклика.  

Кроме того, посетителям можно будет предоставить персонализированные
рекомендации, на основе их эмоциональных предпочтений.  

Обучение нейронной сети выполнено на основе [набора данных Kaggle](https://www.kaggle.com/datasets/sujaykapadnis/emotion-recognition-dataset).  

Для запуска [jupyter-ноутбука](./hackaton.ipynb), выполняющего обучение
модели, его необходимо скачать и распаковать в директорию с ноутбуком.  

Обученные модели сохраняются, начиная с 15й эпохи, в папку `~/data/torch`,
её необходимо создать заранее.  

Уже обученную таким образом модель можно скачать
[здесь](https://drive.google.com/file/d/1cZaV8ab__-jepbpBx2gtjUWeRXeEn-a6/view).

#### Архитектура

Приложения состоит из двух частей: frontend(приложение на react.js) и backend(серверная часть, разработанная с использованием fastAPI). Части общаются между собой посредством WebSocket.
Frontend отправляет захваченное изображение в backend и получает в ответ оценку "предсказания" эмоции.

Ответ бэкэнда состоит из двух ключей "predictions" и "emotion". Ключ "prediction" состоит из вероятностей "предсказания" каждой эмоции, которые используются для изменения значений шкалы эмоций с каждым кадром. Ключ "emotion" содержит доминирующую эмоцию, которая используется для динамического изменения цвета границы, определенной вокруг человеческого лица. Область вокруг лица определяется с помощью модели TensorflowJS.

#### Используемые технологии и библиотеки
1. ReactJS.
    - Использован для разработки UI.
2. FastAPI.
    - Фреймворк для быстрой разработки серверной части проекта.
3. Tensorflow Keras.
   - Модель возвращаеет вероятностною оценку определения эмоций.
4. Tensorflow JS.
   - Обнаружение лиц на изображении с помощью архитектуры Single Shot Detector с пользовательским модели Blazeface.